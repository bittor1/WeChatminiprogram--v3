<view class="container">
  <!-- ä¸ªäººä¿¡æ¯å¡ç‰‡ -->
  <view class="profile-card card p-16">
    <view class="profile-avatar-container">
      <image class="profile-avatar" src="{{userInfo.avatar}}" mode="aspectFill"></image>
      <view class="rank-tag">#{{userInfo.rank}}</view>
    </view>
    
    <text class="profile-name h2">{{userInfo.name}}</text>
    <text class="profile-title text-body">ä¼¦æ•¦å¾—åƒç‹è€…</text>
    
    <view class="badge-row flex justify-center gap-12 my-16">
      <view class="badge badge-red">ğŸ”¥ ç«çƒ­æ¦œé¦–</view>
      <view class="badge badge-purple">è¿ç»­3å‘¨ç¬¬ä¸€</view>
    </view>
    
    <view class="points-display flex justify-center items-center">
      <text class="points-number">{{userInfo.votes}}</text>
      <text class="points-label text-body">äººæƒ³åƒ</text>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’®ç»„ -->
  <view class="action-buttons card p-16">
    <button class="action-btn btn btn-accent-green" bindtap="handleVote">
      <text class="btn-icon">ğŸ‘</text>
      <text class="btn-text">æŠ•ç¥¨</text>
    </button>
    <button class="action-btn btn btn-secondary" bindtap="handleDownVote">
      <text class="btn-icon">ğŸ‘</text>
      <text class="btn-text">å‡ç¥¨</text>
    </button>
    <button class="action-btn btn btn-secondary" bindtap="handleShare">
      <text class="btn-icon">â†—</text>
      <text class="btn-text">åˆ†äº«</text>
    </button>
  </view>

  <!-- éŸ³æ•ˆåŠŸèƒ½åŒº -->
  <view class="sound-section card p-16">
    <button class="sound-btn btn btn-accent-purple" bindtap="playSound">
      <text class="btn-icon">ğŸ¤</text>
      <text class="btn-text">å½•åˆ¶æŠ•ç¥¨éŸ³æ•ˆ</text>
    </button>
    <button class="record-btn btn btn-secondary" bindtap="recordSound">
      <text class="btn-icon">âœ“</text>
      <text class="btn-text">ç¡®è®¤éŸ³æ•ˆ</text>
    </button>
  </view>

  <!-- å¼¹å¹•è¾“å…¥åŒº -->
  <view class="danmaku-input-section card p-16">
    <view class="danmaku-input-row flex gap-12">
      <input 
        class="danmaku-input input flex-1"
        placeholder="å‘ä¸ªå¼¹å¹•è°ƒä¾ƒä¸€ä¸‹..." 
        value="{{danmakuText}}" 
        bindinput="onDanmakuInput"
      />
      <button class="action-btn btn btn-accent-purple" bindtap="sendDanmaku">
        <text class="btn-icon">âœˆï¸</text>
        <text class="btn-text">å‘é€</text>
      </button>
    </view>
  </view>

  <!-- æˆ˜ç»©å¢™ -->
  <view class="achievements-section card p-16 mb-16">
    <view class="section-header flex items-center mb-16">
      <text class="section-icon">ğŸ†</text>
      <text class="section-title h2">æˆ˜ç»©å¢™</text>
    </view>
    
    <view class="achievements-list">
      <view class="achievement-item {{item.type === 'success' ? 'success' : item.type === 'fail' ? 'fail' : 'neutral'}}" 
        wx:for="{{achievements}}" 
        wx:key="id"
      >
        <text class="achievement-icon">{{item.icon}}</text>
        <view class="achievement-content">
          <text class="achievement-text text-body">{{item.content}}</text>
          <view class="achievement-meta flex gap-8">
            <text class="achievement-date text-small">{{item.date}}</text>
            <text wx:if="{{item.location}}" class="achievement-location text-small">Â· {{item.location}}</text>
          </view>
        </view>
      </view>
      
      <button class="add-achievement-btn" bindtap="addAchievement">
        <text class="add-icon">â•</text>
        <text class="add-text text-body">çˆ†æ–™æ–°äº‹è¿¹</text>
      </button>
    </view>
  </view>
  
  <!-- è¯„è®ºåŒº -->
  <view class="comments-section card p-16 mb-16">
    <view class="section-header flex items-center mb-16">
      <text class="section-icon">ğŸ’¬</text>
      <text class="section-title h2">è¯„è®ºåŒº</text>
    </view>
    
    <view class="comments-list">
      <view class="comment-item" wx:for="{{comments}}" wx:key="id">
        <view class="comment-avatar">
          <text>{{item.user[0]}}</text>
        </view>
        <view class="comment-content">
          <view class="comment-header">
            <text class="comment-user text-body">{{item.user}}</text>
            <text class="comment-time text-small">{{item.timestamp}}</text>
          </view>
          <text class="comment-text text-body">{{item.content}}</text>
        </view>
      </view>
      
      <view class="comment-input-row flex gap-12 mt-16">
        <input class="comment-input input flex-1" placeholder="å†™è¯„è®º..." bindinput="onCommentInput" value="{{commentText}}"/>
        <button class="action-btn btn btn-accent-purple" bindtap="sendComment">
          <text class="btn-icon">âœˆï¸</text>
          <text class="btn-text">å‘é€</text>
        </button>
      </view>
    </view>
  </view>

  <!-- å¼¹å¹•å±‚ -->
  <view class="danmaku-layer">
    <view 
      class="danmaku-item" 
      wx:for="{{danmakuList}}" 
      wx:key="id"
      style="top: {{item.top}}%; animation-duration: {{item.duration}}ms;"
    >
      {{item.text}}
    </view>
  </view>
  
  <!-- å¼¹çª— -->
  <view class="modal-overlay" wx:if="{{showModal}}" bindtap="closeModal">
    <view class="modal-content card" catchtap="stopPropagation">
      <view class="modal-header flex justify-between p-16">
        <text class="modal-title h2">{{modalTitle}}</text>
        <button class="modal-close-btn" bindtap="closeModal">âœ•</button>
      </view>
      
      <view class="modal-body p-16">
        <!-- æŠ•ç¥¨å¼¹çª— -->
        <view wx:if="{{modalType === 'vote'}}" class="vote-modal flex flex-col gap-16">
          <view class="custom-vote-section">
            <text class="section-label h2 mb-8">è‡ªå®šä¹‰æŠ•ç¥¨æ•°</text>
            <view class="flex items-center gap-12 mb-16">
              <view class="vote-count-control flex items-center">
                <button class="vote-count-btn" bindtap="decreaseCustomVotes">-</button>
                <input class="vote-count-input" type="number" value="{{customVoteCount}}" bindinput="onCustomVoteInput"/>
                <button class="vote-count-btn" bindtap="increaseCustomVotes">+</button>
              </view>
              <text class="vote-price text-body">Â¥{{customVoteCount}}.00 ({{customVoteCount}}ç¥¨)</text>
            </view>
            <button class="modal-btn btn btn-accent-green" bindtap="buyCustomVotes">
              ç¡®è®¤æŠ•ç¥¨
            </button>
          </view>
        </view>
        
        <!-- å‡ç¥¨å¼¹çª— -->
        <view wx:if="{{modalType === 'downvote'}}" class="vote-modal flex flex-col gap-16">
          <button class="modal-btn btn btn-accent-green" bindtap="buyDownVotes" data-type="pay">
            å¾®ä¿¡æ”¯ä»˜ Â¥2.00 (å‡1ç¥¨)
          </button>
          <button class="modal-btn btn btn-secondary" bindtap="buyDownVotes" data-type="ad">
            è§‚çœ‹å¹¿å‘Š Â¥1.00 (å‡1ç¥¨)
          </button>
        </view>
        
        <!-- äº‹è¿¹å¼¹çª— -->
        <view wx:if="{{modalType === 'achievement'}}" class="achievement-modal flex flex-col gap-16">
          <textarea 
            class="achievement-textarea" 
            placeholder="è¯´è¯´TAçš„ç²¾å½©äº‹è¿¹..." 
            value="{{newAchievement}}"
            bindinput="onAchievementInput"
          ></textarea>
          <button 
            class="modal-btn btn btn-primary" 
            bindtap="submitAchievement"
            disabled="{{!newAchievement.trim()}}"
          >
            æ·»åŠ äº‹è¿¹
          </button>
        </view>
      </view>
    </view>
  </view>
  
  <!-- è¿”å›æŒ‰é’® -->
  <view class="back-to-home-btn" bindtap="goBackToHome">
    <text class="back-icon">â†</text>
  </view>
</view>

